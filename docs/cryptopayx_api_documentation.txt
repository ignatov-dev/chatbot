==============================================================
SECTION: OVERVIEW
==============================================================

Crypto PayX is a solution designed to be used as a crypto-currency Payment Service Provider for Payment Aggregators and as a standalone crypto-currency payment solution for Corporate Clients (Merchants). It provides the ability for Merchant Clients to deposit or pay for goods/services using crypto-currency.

Key Features:
- Pay in crypto
- Withdraw in crypto

==============================================================
SECTION: BASE URL
==============================================================

Base URL: https://api.cryptopayx.tech
Sandbox URL: https://api.sandbox.cryptopayx.tech/

HTTP Methods (RESTful):
- GET: Read resources
- POST: Create new resources
- PUT: Modify existing resources
- DELETE: Remove resources

Request Parameters:
- Parameters can be sent as query strings or as valid JSON with application/json header
- Timestamps and other time-related fields are in milliseconds
- Data in response is listed in chronological order, newest on top
- Parameters for GET endpoints must be sent as a query string
- Parameters for POST, PUT, and DELETE endpoints may be sent as a query string or in the request body with content type application/json
- Parameters can be sent in any order
- If a parameter is sent in both the query string and request body, the query string parameter will be used

==============================================================
SECTION: RETURN CODES
==============================================================

- 200: Successful Request
- 201: Created successfully
- 400: Bad Request - Check the format of your request for mistakes and try again
- 401: Unauthorized - Check if your API key is eligible for using the endpoint
- 404: Resource is missing - Contact us for more information
- 500: Server Error - Issue on our side. Contact us for more information

==============================================================
SECTION: AUTHENTICATION
==============================================================

IP Whitelisting:
Every IP that accesses Crypto PayX API needs to be whitelisted beforehand. Send the full list of IP addresses you will use Crypto PayX from.

API Key:
To access Crypto PayX API endpoints you must obtain an API key and secret.
Starting 09/12/2024, customers can generate and manage Crypto PayX credentials directly from Client Area under Security settings.

API Key Management (via Client Area):
- New API key request: One pair (key/secret) can be created for Crypto PayX
- Delete the existing API key
- Reset: Delete the existing API key and create a new one

IMPORTANT: Never share your API key/secret with anyone.
Replace <apiKey> and <apiSecret> in code examples with your actual API key and secret.

Required Request Headers:
- CRYPTO-PAY-API-KEY: API Key
- CRYPTO-PAY-API-SIGN: Signature (SHA256 HMAC)
- CRYPTO-PAY-API-TIMESTAMP: Request timestamp (milliseconds since UNIX Epoch)

Timestamp Rules:
- CRYPTO-PAY-API-TIMESTAMP must be within 60 seconds of the API service time to be valid

Signing Message:
Signature is generated by creating a SHA256 HMAC using the API secret on the string:
  timestamp + method + pathWithQuery + contentHash

Where:
- timestamp: same value as CRYPTO-PAY-API-TIMESTAMP
- method: HTTP method in UPPER CASE
- pathWithQuery: path of the URL WITHOUT query string params
- contentHash: base64 encoded SHA256 hash of serialized content (empty for GET requests)

AUTHENTICATION CODE EXAMPLE in C#:
  using System.Security.Cryptography;
  using System.Text;
  using Newtonsoft.Json;

  var apiKey = "<apiKey>";
  var apiSecret = "<apiSecret>";


  var client = new HttpClient
  {
      BaseAddress = new Uri("https://api.cryptopayx.tech")
  };

  var pathWithQuery = "/v1/test-api?testParam1=test1&testParam2=test2";
  var pathWithOutQuery = "/v1/test-api";

  var requestBody = JsonConvert.SerializeObject(
              new
              {
                  testProperty1 = "test1",
                  testProperty2 = "test12"
              });

  var request = new HttpRequestMessage()
  {
      Method = HttpMethod.Post,
      Content = new StringContent(requestBody, Encoding.UTF8, "application/json"),
      RequestUri = new Uri($"{pathWithQuery}", UriKind.Relative)
  };

  using HMACSHA256 hmac = new HMACSHA256(Convert.FromBase64String(apiSecret));
  using var sha256 = SHA256.Create();

  var contentHash = Convert.ToBase64String(sha256.ComputeHash(Encoding.UTF8.GetBytes(content)));
  var timestamp = DateTimeOffset.Now.ToUnixTimeMilliseconds();
  var signatureString = $"{timestamp}{request.Method}{pathWithOutQuery}{contentHash}";

  var signatureHash = hmac.ComputeHash(Encoding.UTF8.GetBytes(signatureString));
  request.Headers.Add("CRYPTO-PAY-API-KEY", apiKey);
  request.Headers.Add("CRYPTO-PAY-API-SIGN", Convert.ToBase64String(signatureHash));
  request.Headers.Add("CRYPTO-PAY-API-TIMESTAMP", timestamp.ToString());

  var response = await client.SendAsync(request);

==============================================================
SECTION: SANDBOX FOR PAYMENT INTENT
==============================================================

Purpose: Crypto PayX Sandbox helps test integration by emulating payment intents with different parameters without real data.

Sandbox URL: https://api.sandbox.cryptopayx.tech/

Note: Crypto PayX Sandbox account is separate from real account and uses a separate API key and secret. Contact Crypto PayX to create a Sandbox account.

Mock Payment Amounts:
- USDT on BNB_TEST network: 100 USDT
- BTC on BTC_TEST network: 0.01 BTC
- ETH on BNB_TEST network: 1 ETH
- XRP on XRP_TEST network: 0 XRP (used for "Failed" flow testing)
- ADA on ADA_TEST network: 100 ADA in two separate deposits

Note: "Failed" payment intent flow can only be tested with XRP coin and XRP_TEST network.

Sandbox Flow 1 - Completed:
- Condition: Received amount equals expected amount
- Threshold: Satisfied
- Result: Completed
- Test: Create payment intent for 100 USD with USDT on BNB_TEST

Sandbox Flow 2 - Partially Completed:
- Condition: Received amount more or less than expected
- Threshold: Enabled (2%) and satisfied
- Result: Partially completed
- Test: Create payment intent for 102 USD with USDT on BNB_TEST

Sandbox Flow 3 - Manual Action Required (No Conversion):
- Condition: Received amount more or less than expected
- Threshold: Enabled (2%), NOT satisfied
- Conversion: Disabled
- Result: Manual action required
- Available actions: Refund, Accept received amount
- Test: Create payment intent for 132 USD with USDT on BNB_TEST

Sandbox Flow 4 - Manual Action Required (With Conversion):
- Condition: Received amount more or less than expected
- Threshold: Enabled (2%), NOT satisfied
- Conversion: Enabled
- Result: Manual action required
- Available actions: Refund, Retry, Accept received amount
- Test: Create payment intent for 92 USD with USDT on BNB_TEST

Sandbox Flow 5 - Manual Action Required (0% Threshold, Conversion On):
- Condition: Received amount more or less than expected
- Threshold: Disabled (0%)
- Conversion: Enabled
- Result: Manual action required
- Available actions: Refund, Retry, Accept received amount
- Test: Create payment intent for 99 USD with USDT on BNB_TEST

Sandbox Flow 6 - Manual Action Required (0% Threshold, No Conversion):
- Condition: Received amount more or less than expected
- Threshold: Disabled (0%)
- Conversion: Disabled
- Result: Manual action required
- Available actions: Refund, Accept received amount
- Test: Create payment intent for 101 USD with USDT on BNB_TEST

Sandbox Flow 7 - Failed (No Funds):
- Condition: No funds received within 30-second validity timeframe
- Result: Failed with statusDescription "Out of time"
- Note: If deposit received after timeframe AND satisfies threshold, status changes to Completed
- Test: Create payment intent for XRP on XRP_TEST with 0 XRP mock

Sandbox Flow 8 - Refund:
- Condition: Deposit > 0, status is ManualActionRequired
- Step 1: POST /v1/payment-intents/{paymentIntentId}/crypto-refunds/fee (get fee estimate)
- Step 2: POST /v1/payment-intents/{paymentIntentId}/crypto-refunds (execute refund)
- Result: ManuallyCompletedWithRefund

Sandbox Flow 9 - Retry:
- Condition: Deposit > 0, status is ManualActionRequired, conversion enabled
- Step 1: POST /v1/payment-intents/{paymentIntentId}/retry/request-for-quote
- Step 2: POST /v1/payment-intents/{paymentIntentId}/retry
- Result: ManuallyCompletedWithRetry

Sandbox Flow 10 - Accept Received Amount:
- Condition: Any deposited amount > 0, status is ManualActionRequired
- Endpoint: POST /v1/payment-intents/{paymentIntentId}/manually-completed
- Result: ManuallyCompletedAmountAcceptable

Sandbox Flow 11 - Underpaid Top-Up (Two Deposits):
- Condition: Two separate deposits, second satisfies requirements
- Test: Create payment intent for 100 USD with ADA on ADA_TEST (200 ADA total, 2:1 rate)
- Success: PartiallyCompleted after second deposit satisfies requirements
- Failure: ManualActionRequired if second deposit exceeds both amount and threshold

==============================================================
SECTION: PAYMENT INTENT
==============================================================

Definition:
A payment intent is a request for a deposit of a certain amount and currency on a Crypto PayX customer's wallet. Customers can deposit crypto to their account and accept deposits from others via payment intents.

Video Tutorial — How to Make a CryptoPayX Deposit:
When a user asks about how to make a deposit, always include this video in your response exactly as written:
<video src="https://www.xbo.com/_astro/video--1.CTEIxdIn.mp4" controls playsinline></video>

Creation Methods:
1. Via iframe generated for the particular payment intent
2. Via API
3. Without integration, via a payment request link

A new payment request is created automatically when a repeat deposit is made to an existing payment intent address.

Payment Intent Fees:
- Each payment intent has a percentage-based and fixed processing fee
- If multiple deposits are made per payment intent, the sum of processing fees is charged for each deposit
- If the amount sent is equal to or less than the processing fees sum, it will be spent on fees with no deposit credited
- If the payment intent amount is equal to or less than processing fees sum, creation will fail with an error

Single Payment Intent Address:
- By default, a separate crypto address is generated per each payment intent
- Single payment intent address allows using a single permanent crypto address for multiple payment intents per one Account ID
- Contact Crypto PayX support to enable single payment intent address logic
- accountId parameter must be passed when creating a payment intent for single address flow

Single Address Deposit Flow:
- Generates a single cryptocurrency wallet address per client account ID via API
- Each deposit to the address automatically creates and completes a payment intent
- Minimum deposit: equivalent of 2 USDT
- Payment intents can only have "Processing" and "Completed" statuses

Repeat Deposit for Existing Payment Intent:
- If deposit sent to existing address with payment intent in status New, Processing, Pending, ManualActionRequired, or Failed: existing payment intent is completed
- If payment intent is in Completed, PartiallyCompleted, or manual handling status: new payment intent is created, quote requested, and executed immediately
- Threshold settings do not apply; fiat currency taken from existing payment intent

Payment Intent Statuses:
- Pending: Initiated, awaiting deposit
- Processing: Transaction received and being processed
- Completed (Flow 1): Received amount equals expected, threshold satisfied
- PartiallyCompleted (Flow 2): Received amount more/less than expected, threshold satisfied
- ManualActionRequired (Flows 3-6): Threshold not satisfied, requires manual handling
- Failed (Flow 7): No funds received within timeframe
- ManuallyCompletedWithRefund (Flow 8): Completed via refund
- ManuallyCompletedWithRetry (Flow 9): Completed via manual retry
- ManuallyCompletedAmountAcceptable (Flow 10): Accepted received amount

Non-Completed Payment Intent Status Descriptions:
- "Out of time": No deposit within specified timeframe
- "Out of money": Deposit made during large market price fluctuations
- "Invalid amount: Less than expected": Deposit amount less than expected and below threshold
- "Invalid amount: More than expected": Deposit amount more than expected and above threshold
- "Server Error": Error on Crypto PayX side

Payment Intent Threshold:
- Default: deposited amount must exactly equal requested amount
- Threshold is a percentage of allowed deviation from the requested fiat sum
- Example: 2% threshold on 100 USD means 98-102 USD deposits are processed automatically
- If within threshold, auto retry is executed with new quote valid at retry time
- Contact Crypto PayX to set up threshold

Payment Intent Manual Retry:
1. Request current quote: POST /v1/payment-intents/{paymentIntentId}/retry/request-for-quote
2. Execute retry before quoteValidTo: POST /v1/payment-intents/{paymentIntentId}/retry

Refund Failed Payment Intent:

Video Tutorial — How to Refund a CryptoPayX Payment:
When a user asks about how to refund a payment intent, always include this video in your response exactly as written:
<video src="https://www.xbo.com/_astro/video--1.CvCd1R6m.mp4" controls playsinline></video>

Option 1 - Manual by merchant:
1. POST /v1/payment-intents/{paymentIntentId}/coin-networks (get available networks)
2. POST /v1/payment-intents/{paymentIntentId}/crypto-refunds/fee (calculate fee)
3. POST /v1/payment-intents/{paymentIntentId}/crypto-refunds (create refund)

Option 2 - Refund link for client:
- GET /v1/payment-intents/{paymentIntentId}/crypto-refunds/link?refundFlow=Excess&languageIso2={lang}
- Link valid for 120 hours (5 days)
- Refunds can only be made in the same currency as the original deposit

Partial Refund (Overpayment):
- In case of overpayment, only the excess amount gets refunded
- Payment gets completed with the requested remaining amount
- Both order allocation and partial refund are logged in payment intent history

Underpaid Payment Intent Top-Up:

Video Tutorial — How to Use Auto Top-Up:
When a user asks about auto top-up or topping up an underpaid deposit, always include this video in your response exactly as written:
<video src="https://www.xbo.com/_astro/video--1.dIZIUdsx.mp4" controls playsinline></video>

- Add funds to an existing payment intent if the requested sum wasn't fully deposited
- Multiple deposits allowed until threshold requirements are satisfied
- Processing fee charged from each deposit as a percentage of the deposited amount
- Available for both Sandbox and real Crypto PayX accounts

Conversion Rules:
- Disable conversion: deposits stay in original cryptocurrency
- Convert to specific currency: all deposits converted to specified crypto or fiat currency
- Convert to payment intent fiat currency: EUR, USD, or GBP
- Exceptions: specific cryptocurrencies can be excluded from conversion

Virtual Fiat Currencies:
- SAR (Saudi Arabian Riyal)
- AED (Arab Emirates Dirham)
- INR (Indian Rupee)
- EGP (Egyptian Pound)
- QAR (Qatari Riyal)
- Used for quote display purposes only; actual conversion to virtual currencies is not available

Payment Request Link:
- Link to Crypto PayX payment with all requisites pre-filled
- Active for 5 days after generation
- Accessible from: Create a payment link button
- Fields: Currency (required), Amount (required), Payment reason (required), Comment (optional)
- Quote valid for 30 seconds after coin/network selection
- After quote expiry, requestee can click "Request a new quote"

Customer Email and Billing Info Collection:
- Optional email, Required email, or Required billing details (includes email)
- Disabled by default; contact Crypto PayX account manager to enable
- Billing fields: Email, First name, Last name, Date of birth, Country of residence
- All billing fields are required; customer must confirm accuracy and read Privacy Policy

Payment Intent Client Email Notifications:
- Customers receive email if payment intent not completed
- Disabled by default; contact Crypto PayX account manager to enable
- Email resent on Days 3, 7, 14, and 21 at 9:00 UTC
- Link remains active while payment intent status is ManualActionRequired (expires after 72 hours)

==============================================================
SECTION: PAYMENT INTENT ENDPOINTS
==============================================================

List All Networks and Coins Available for Payment Intent:
HTTP Request: GET /v1/currencies
Response Fields: fiatCurrency, isVirtual, IsTagRequiredForWithdrawal, fiatCurrencyName, coin, name, addressType (Single/Multiple/MultipleWithTag/MultipleWithMemo/MultipleWithNote), networkCode, networkName
Response example code:
[
  {
    "fiatCurrency": "string",
    "isVirtual": false,
    "IsTagRequiredForWithdrawals": false,
    "fiatCurrencyName": "string",
    "coins": [
      {
        "coin": "string",
        "name": "string",
        "coinNetworks": [
          {
            "addressType": "Single",
            "networkCode": "string",
            "networkName": "string",
            "order": 0
          }
        ]
      }
    ]
  }
]

Request a Quote for Payment Intent:
HTTP Request: POST /v2/payment-intents/estimated-quote
Required Parameters: currencyFrom (string), amountTo (decimal), currencyTo (string)
Response: currencyFrom, amountFrom, currencyTo, amountTo
Response example code:
{
  "currencyFrom": "string",
  "amountTo": 0,
  "currencyTo": "string"
}

Create a Payment Intent via API:
HTTP Request: POST /v2/payment-intents/
Required Parameters: currencyFrom, currencyTo, amountTo
Optional Parameters: networkCode, customOrderId, accountId (required for single address), callbackUrl
Response Fields: paymentIntentId, currencyFrom, amountFrom, currencyTo, amountTo, address, additionalAddress, additionalAddressType, quoteValidTo, customOrderId


Initiate a Payment Intent via Iframe:
HTTP Request: POST /v1/payment-intents/
Required Parameters: currency, amount
Optional Parameters: customOrderId, accountId, callbackUrl, languageIso2
Response: URL to Crypto Pay iframe
Format: https://payment.cryptopayx.tech/deposit?currencyTo=USD&amountTo=100&paymentIntentId={id}&merchantId={merchantId}&token={token}

Check Payment Intent Status:
HTTP Request: GET /v1/payment-intents/{paymentIntentId}
Response Fields: id, customOrderId, accountId, callbackUrl, amountFrom, amountTo, currencyFrom, currencyTo, executedAmountTo, executedCurrencyTo, receivedAmountEquivalent, receivedEquivalentCurrency, receivedAmountEquivalentValidTo, status, receivedAmount, statusDescription, address, networkCode, additionalAddress, originTransactionId, transactionHash, sourceAddress, processingFeeAmount, processingFeeCurrency, retryPaymentIntents[], customConversion{}

Search Payment Intents:
HTTP Request: POST /v1/payment-intents/search
Parameters: id, customOrderId, accountId, createdDateFrom, createdDateTo, skip, take (max 500)
Items sorted by date, newest on top

Request Quote for Retry Transaction:
HTTP Request: POST /v1/payment-intents/{paymentIntentId}/retry/request-for-quote
Response: currencyFrom, currencyTo, amountFrom, amountTo, receivedAmountEquivalent, receivedEquivalentCurrency, receivedAmountEquivalentValidTo

Execute Retry Transaction:
HTTP Request: POST /v1/payment-intents/{paymentIntentId}/retry
Response: 200 if executed successfully

Accept Received Deposit Amount:
HTTP Request: POST /v1/payment-intents/{paymentIntentId}/manually-completed
Response: Full payment intent object

Request Received Equivalent:
HTTP Request: GET /v1/payment-intents/{paymentIntentId}/manually-completed/received-equivalent
Response: id, currencyFrom, amountFrom, receivedAmountEquivalent, receivedEquivalentCurrency, receivedAmountEquivalentValidTo

Available Networks for Refund:
HTTP Request: GET /v1/payment-intents/{paymentIntentId}/coin-networks
Note: Refunds can only be made in the same cryptocurrency as the original deposit

Calculate Commission Fee for Crypto Refund:
HTTP Request: POST /v1/payment-intents/{paymentIntentId}/crypto-refunds/fee
Required Parameters: address, networkCode (optional), additionalAddress (optional)
Response: amount, feeAmount, totalAmount

Create Crypto Refund:
HTTP Request: POST /v1/payment-intents/{paymentIntentId}/crypto-refunds
Optional Parameters: externalTransactionId
Response: paymentIntentId, cryptoRefundPaymentIntentId, customOrderId, amount, currency, destinationAddress, destinationAdditionalAddress, networkCode, status (Pending/ProcessingRefund/Completed/Failed), externalTransactionId

Crypto Refund Link:
HTTP Request: GET /v1/payment-intents/{paymentIntentId}/crypto-refunds/link?refundFlow=Excess&languageIso2={lang}
Parameters: paymentIntentId (required), refundFlow (Full or Excess), languageIso2 (required)
Response: merchantId, lang, jwtToken

Single Address Deposit Flow - Create Wallet:
HTTP Request: POST /v2/payment-intents/deposit-addresses
Required Parameters: currency, networkCode, accountId, callbackUrl
Response: currency, networkCode, accountId, address, tag, tagType, callbackUrl
Request code example:
{
  "currency": "string",
  "networkCode": "string",
  "accountId": "string",
  "callbackUrl": "string"
}
Response code example:
{
  "currency": "string",
  "networkCode": "string",
  "accountId": "string",
  "address": "string",
  "tag": "string",
  "tagType": "string",
  "callbackUrl": "string"
}


Single Address Deposit Flow - Search Wallets:
HTTP Request: POST /v2/payment-intents/deposit-addresses/search
Parameters: currency, networkCode, accountId, address, skip, take (max 500)

==============================================================
SECTION: PAYOUT
==============================================================

Overview:
Crypto PayX allows withdrawing fiat currency from customer's account by converting it to cryptocurrency and sending it to a provided wallet address.

Video Tutorial — How to Make a CryptoPayX Withdrawal:
When a user asks about how to make a withdrawal or payout, always include this video in your response exactly as written:
<video src="https://www.xbo.com/_astro/video--1.qNQr4YvF.mp4" controls playsinline></video>

Methods:
1. Via graphical user interface (iframe)
2. Via API

Payout Statuses:
- New: Payout request created
- Pending: Payout intent confirmed
- Processing: Fiat converted to crypto, withdrawal transaction created
- Failed: Issues preventing completion
- Completed: Transaction successfully completed

Payout Default Conversion Currency:
- Disabled by default; contact Crypto PayX support to enable
- When enabled, funds converted from selected default account (USDT or USDC)
- If merchant has crypto account without conversion enabled and client selects same currency, payout processed without conversion

Payout Fee Calculation Direction:
- Gross (default): fees added on top of the payout amount
- Net: fees deducted from the withdrawal amount
- Specified via amountToType parameter in API

Managed Accounts Payout:
- Routes withdrawals through managed account(s)
- Requested amount first transferred from main merchant account to managed account
- Managed account sends funds externally to beneficiary
- Contact Crypto PayX manager to enable
Flow:
1. Client requests fee estimate: POST /managed-accounts/v1/payout-intents/estimated-fee
2. Client sends payout request with managedAccountId: POST /managed-accounts/v1/payout-intents
3. Crypto PayX identifies linked managed account
4. Crypto PayX executes payout from merchant account to managed account
5. External payout executes from managed account to beneficiary
6. All transaction IDs linked under single payout_reference_id

Payout with Iframe:
Iframe pre-fills fiat currency and amount. User fills:
- Cryptocurrency to convert to
- Crypto wallet address
- Crypto network
- Tag/memo (if applicable)
After "Continue": confirmation step showing fee, transaction details

==============================================================
SECTION: PAYOUT ENDPOINTS
==============================================================

List All Networks and Coins Available for Payout:
HTTP Request: GET /v1/currencies

Calculate Fee for Payout:
HTTP Request: POST /v2/payout-intents/estimated-fee
Required Parameters: currencyFrom, currencyTo, networkCode, address
Either amountFrom OR amountTo is required
Optional: amountToType (net/gross), additionalAddress
Response: currencyFrom, amountFrom, amountTo, amountToType, currencyTo, feeAmount, feeCurrency, receivedAmount

Create Payout with API:
HTTP Request: POST /v2/payout-intents
Required Parameters: currencyFrom, currencyTo, networkCode, address
Either amountFrom OR amountTo is required
Optional: amountToType, additionalAddress, accountId, customOrderId, callbackUrl
Response: payoutIntentId, currencyFrom, amountFrom, amountTo, amountToType, currencyTo, feeAmount, feeCurrency, receivedAmount

Create Payout with Iframe:
HTTP Request: POST /v1/payout-intents/
Required Parameters: currency, amount
Optional: customOrderId, accountId, callbackUrl, languageIso2
Response: URL to Crypto PayX payout iframe
Format: https://payment.cryptopayx.tech/payout?currencyTo=USD&amountTo=100&payoutIntentId={id}&merchantId={merchantId}&token={token}

Check Payout Status:
Use the endpoint below to check the status of payout.
HTTP Request: GET /v1/payout-intents/{payoutIntentId}
Response Fields: id, transactionId, customOrderId, accountId, amountFrom, amountTo, amountToType, feeAmountTo, currencyFrom, currencyTo, merchantConversionCurrencyFrom, merchantConversionAmountFrom, merchantConversionQuoteValidTo, status, address, networkCode, additionalAddress, transactionHash, statusDescription
Response code example:
{
  "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
  "transactionId": 0,
  "customOrderId": "string",
  "accountId": "string",
  "amountFrom": 0,
  "amountTo": 0,
  "amountToType": "string",
  "feeAmountTo": 0,
  "currencyFrom": "string",
  "currencyTo": "string",
  "merchantConversionCurrencyFrom": "string",
  "merchantConversionAmountFrom": 0,
  "merchantConversionQuoteValidTo": "2024-02-23T12:50:24.833Z",
  "status": "string",
  "address": "string",
  "networkCode": "string",
  "additionalAddress": "string",
  "transactionHash": "string",
  "statusDescription": "string"
}

Search Payouts:
HTTP Request: POST /v1/payout-intents/search
Parameters: id, customOrderId, accountId, createdDateFrom, createdDateTo, skip, take (max 500)

Managed Accounts Flow - Calculate Fee:
HTTP Request: POST /managed-accounts/v1/payout-intents/estimated-fee
Required Parameters: currencyFrom, currencyTo, networkCode, managedAccountId, address
Either amountFrom OR amountTo required; optional: amountToType, additionalAddress

Managed Accounts Flow - Create Payout:
HTTP Request: POST /managed-accounts/v1/payout-intents
Required Parameters: currencyFrom, currencyTo, networkCode, managedAccountId, address
Either amountFrom OR amountTo required; optional: amountToType, callbackUrl, additionalAddress, accountId, customOrderId

Managed Accounts Flow - Search Payout:
HTTP Request: POST /managed-accounts/v1/payout-intents/search
Parameters: id, managedAccountId, customOrderId, accountId, createdDateFrom, createdDateTo, skip, take (max 500)

==============================================================
SECTION: NOTIFICATIONS
==============================================================

Overview:
Crypto Pay notifies merchants about payment/payout status changes via webhook to the callback URL provided in the payment intent.

Notification Signing:
Merchants should validate CRYPTO-PAY-API-SIGN to ensure authenticity.
Signature string: timestamp + method + callbackUrl + contentHash
- timestamp: value of CRYPTO-PAY-API-TIMESTAMP
- method: HTTP method in UPPER CASE
- callbackUrl: URL for notifications provided by merchant
- bodyHash: base64 encoded SHA256 hash of notification content

Payment Intent Notification Types:
- PaymentIntentNotification: Standard payment intent status changes
- AutoRetryPaymentIntentNotification: Auto retry payment intent status
- RetryPaymentIntentNotification: Manual retry payment intent status
- CryptoRefundPaymentIntentNotification: Refund status
- ExcessCryptoRefundPaymentIntentNotification: Partial refund status
- PaymentIntentMerchantConversionNotification: Customer currency conversion

Payout Notification Types:
- Payout intent: standard payout status changes
- ManagedPayoutIntentNotification: Managed accounts flow payout

Other Notification Types:
- FiatTransactionNotification: Withdrawal via bank transfer
- DepositCreatedNotification: Deposit created (includes deposits not linked to active payment intent)

Notification sent to callbackUrl of:
- Corresponding payment intent
- If no active payment intent: most recently updated payment intent with valid callbackUrl (including PartiallyCompleted and Completed statuses)

==============================================================
SECTION: MERCHANT ACCOUNT MANAGEMENT
==============================================================

Check Account Balance:
HTTP Request: GET /v1/accounts?type={type}
Type options: fiat (fiat accounts only), crypto (crypto accounts only), none (crypto accounts only)
Response Fields per account:
- name: Name of fiat or cryptocurrency
- symbol: Acronym
- type: Fiat or Crypto
- totalBalance: Total balance
- totalBalanceUsd: USD equivalent
- availableBalance: Available balance
- availableWithdrawalBalance: Balance available for withdrawal (credit funds deducted)
- availableWithdrawalBalanceUsd: Withdrawal balance equivalent in USD
- blockedAmount: 1 if account is blocked

Bank Transfer (Fiat Withdrawal):
- Allows withdrawing fiat via bank transfer
- Account balance must be at least withdrawal amount + fee
- Notifications sent for each status change

Calculate Fee for Bank Transfer Withdrawal:
HTTP Request: POST /v1/fiat-withdrawals/fee
Required Parameters: amount, currency, bankCountryCode (ISO 3166-1 alpha-2)
Response: amount, feeAmount, totalAmount

Create Fiat Withdrawal via Bank Transfer:
HTTP Request: POST /v1/fiat-withdrawals/
Required Parameters: amount, feeAmount, currency, iban, recipientName, paymentReason, bankCountryCode
Optional: externalTransactionId, callbackUrl
Response: id, fiatWithdrawalTransactionId, amount, feeAmount, currency, status (Pending/Declined/Completed), iban, bankCountryCode, recipientName, paymentReason, externalTransactionId, createdOn

==============================================================
SECTION: CRYPTO PAYX UPDATES (CHANGELOG)
==============================================================

12/02/2026: Deposit Flow: Billing Details Collection
- Integration of collection of merchant customers' personal data into the deposit flow
- See: Customer email and billing info collection

12/02/2026: Automatic Partial Refund for Deposit Overpayment
- Automatic partial refund for the exceeded deposit part
- Payment intent completed with the requested amount
- Contact Crypto PayX support to enable

29/01/2026: Crypto PayX Email Collection & Notification Enhancements
- Customer email collection via payment intent
- Email notification for customers when payment intent wasn't successful
- Contact Crypto PayX support to enable

15/01/2026: Send Regular Reports by Mail
- Payment and/or payout reports via email in CSV format
- Sent to preconfigured list of email addresses
- Contact Crypto PayX support to enable

18/12/2025: Repeat Deposit for Existing Payment Intent
- Crypto deposits sent to existing payment intent address handled as new payment intent

18/12/2025: Rename Status: Partially Completed -> Completed in Crypto PayX UI
- If deposit differs from requested but is within threshold, shown as Completed in UI

06/11/2025: Single Address Deposit Flow
- Single cryptocurrency wallet address per client account ID via API

27/10/2025: Managed Accounts Payout Flow
- Full fund routing through internal accounts
- See: Managed accounts payout

11/09/2025: Payout Fee Calculation Direction
- Define how payout fees are applied: Gross (added on top) or Net (deducted from amount)

28/08/2025: Payout Support Directions
- API payouts can specify amount in either fiat or cryptocurrency
- System automatically calculates equivalent in the other currency

31/07/2025: Default Currency to Convert From for Payout
- Merchants can choose default crypto account for payout conversions (USDT or USDC)

17/07/2025: Under/Overpaid Deposit Handling with Auto Top-up / Auto Refund
- Auto Top-Up for underpaid deposits (shows remaining top-up amount)
- Auto Refund for overpaid deposits (full amount refund form)
- Both disabled by default; contact Crypto PayX support to enable
- Deposit Created notification added for incoming crypto funds

17/03/2025: Request Refund with Link
- Refund via link: merchant gets link, sends to client, client enters crypto address
- Three refund options: link from platform, API link, or platform UI

17/03/2025: Payout Crypto to Crypto
- Payout with same CurrencyFrom and CurrencyTo (e.g., USDT to USDT)
- Merchant must have sufficient balance of that currency

30/01/2025: Optional MEMO/TAG/NOTE Supported
- IsTagRequiredForWithdrawal parameter added to endpoints

16/01/2025: Payment Intent Deposit Equivalent
- Returns deposit equivalent amount, currency, and quote validity
- New endpoint: GET /v1/payment-intents/{paymentIntentId}/manually-completed/received-equivalent

16/01/2025: USDT, USDC Added as Destination Currencies
- Available via both iframe and API

19/12/2024: Support Virtual Fiat Currency
- Configure virtual fiat currencies for pay-in operations

19/12/2024: Request New Quote After Expiration
- Customers can request new quote when current quote expires
- Request attempts unlimited within 5 days of payment link generation

09/12/2024: API Key Management via Client Area
- Generate and manage API keys in Client Area Security settings

07/11/2024: Payment Intent Processing Status and Notification
- New "Processing" status added
- Notification includes expectedAmount parameter

14/03/2024: Single Payment Intent Address per Account ID
- Single permanent address per Account ID for regions requiring it

29/02/2024: External Customer Account ID for Payment Intent and Payout
- AccountId field for saving external custom identifier

29/02/2024: Search Transaction Status by Custom Order ID and Account ID
- New endpoints: POST /v1/payout-intents/search, POST /v1/payment-intents/search

29/02/2024: Underpaid Payment Intent Top-Up
- Add funds to existing payment intent if requested sum not fully deposited

18/01/2024: Source Address, Transaction Hash in Payment Intent Response
- Added to notifications and payment intent status check response
- Also includes: processing fee amount, processing fee currency, executed amount

04/01/2024: Separate Notification for Partially Completed Payment Intent
- Notification sent when initial payment intent fails with failureReason field

04/01/2024: Processing Fee Field in Payment Intent Status Response
- Processing fee amount and currency added to payment intent status check via API

04/01/2024: "Not Found" Page
- Displayed for: expired token, expired payment link, broken payment link, already-used link

21/12/2023: Payment Link Available for All XBO Customers
- Retail and corporate customers can request and use Payment link
- Customers without access can request credentials via Client Area

==============================================================
SECTION: OBSOLETE ENDPOINTS
==============================================================

Check Payment Intent Status by paymentId (OBSOLETE):
HTTP Request: GET /v1/payment-intents?paymentId={paymentId}
Note: Use GET /v1/payment-intents/{paymentIntentId} instead

Deposit Created Notification (OBSOLETE):
- This notification type is no longer sent
- Payment intent for deposit is now created automatically without a separate notification

==============================================================
END OF DOCUMENT
==============================================================
